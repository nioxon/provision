#!/usr/bin/env bash
set -e

BASE=/opt/nioxon
LOGS=$BASE/logs
ENV=$BASE/config/server.env

mkdir -p "$LOGS"
source "$ENV"

run() {
  echo "â–¶ $1"
  bash "$BASE/provision/$1.sh" | tee -a "$LOGS/$1.log"
}

case "$1" in
  install)
    run 00-system
    run 01-security
    run 02-nginx
    run 03-php
    run 04-mysql
    run 05-node
    run 06-redis
    run 07-supervisor
    run 08-site
    run 09-ssl
    run 10-hotspot
    run 11-captive-dns
    ;;
  *)
    echo "Usage: nioxon install"
    ;;
esac
